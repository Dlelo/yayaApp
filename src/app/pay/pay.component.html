<div class="container my-4">
  <mat-card class="p-4 shadow-sm">
    <h2 class="mb-3 text-center">Complete Payment to Hire</h2>
    <p class="lead text-center">
      To hire <strong>{{ houseHelpName }}</strong>, please pay first.
    </p>

    @if (isProcessing) {
      <div class="text-center my-4">
        <mat-spinner diameter="50" class="mx-auto mb-3"></mat-spinner>
        <p class="text-muted">Processing payment... Check your phone for M-Pesa prompt</p>
      </div>
    } @else {
      <form [formGroup]="payForm" (ngSubmit)="pay()" class="mt-4">
        <div class="row g-3">
          <!-- Plan Selection -->
          <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Select Plan</mat-label>
              <mat-select formControlName="plan">
                <mat-option value="basic">Basic – KES 500/month</mat-option>
                <mat-option value="premium">Premium – KES 1000/month</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <!-- Mpesa Number -->
          <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Mpesa Number</mat-label>
              <input matInput formControlName="phone" placeholder="0712345678 or +254712345678" />
              <mat-error *ngIf="payForm.get('phone')?.hasError('required')">
                Phone number is required
              </mat-error>
              <mat-error *ngIf="payForm.get('phone')?.hasError('pattern')">
                Invalid phone number format
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Submit Button -->
          <div class="col-12 text-center">
            <button
              mat-raised-button
              color="primary"
              class="px-4"
              type="submit"
              [disabled]="payForm.invalid || isProcessing"
            >
              Pay & Proceed
            </button>
          </div>
        </div>
      </form>
    }
  </mat-card>
</div>