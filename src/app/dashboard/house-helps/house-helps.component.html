<mat-card class="house-helps-container">
  <div class="card-header">
    <h2 class="title">Manage House Helps</h2>
  </div>

  @if (houseHelpsPage$ | async; as pageData) {
    <div class="table-container">
      <table class="custom-table">
        <thead>
        <tr>
          <th class="col-number">#</th>
          <th class="col-name">Name</th>
          <th class="col-email">Email</th>
          <th class="col-phone">Phone Number</th>
          <th class="col-status">Status</th>
          <th class="col-hiring">Hiring Status</th>
          <th class="col-actions">Actions</th>
        </tr>
        </thead>

        <tbody>
        @for (houseHelp of pageData.content; let i = $index; track houseHelp.id) {
          <tr class="table-row">
            <td class="col-number">
              <span class="index-badge">{{ i + 1 + (pageData.number * pageData.size) }}</span>
            </td>

            <td class="col-name">
              <div class="user-info">
                <span class="name">{{ houseHelp.user?.name }}</span>
              </div>
            </td>

            <td class="col-email">
              <span class="email">{{ houseHelp.user?.email || '—' }}</span>
            </td>

            <td class="col-phone">
              <span class="phone">{{ houseHelp.user?.phoneNumber || '—' }}</span>
            </td>

            <td class="col-status">
              @if (houseHelp?.active) {
                <span class="status-badge active">Active</span>
              } @else {
                <span class="status-badge inactive">Inactive</span>
              }
            </td>

            <td class="col-hiring">
              @switch (houseHelp?.hiringStatus) {
                @case ('HIRED') {
                  <span class="hiring-badge hired">Hired</span>
                }
                @case ('AVAILABLE') {
                  <span class="hiring-badge available">Available</span>
                }
                @case ('UNAVAILABLE') {
                  <span class="hiring-badge unavailable">Unavailable</span>
                }
                @case ('ON_LEAVE') {
                  <span class="hiring-badge on-leave">On Leave</span>
                }
                @default {
                  <span class="hiring-badge unknown">—</span>
                }
              }
            </td>

            <td class="col-actions">
              <div class="action-buttons">
                <button
                  mat-stroked-button
                  color="primary"
                  class="action-btn"
                  (click)="editHouseHelp(houseHelp.user.id)">
                  <mat-icon>edit</mat-icon>
                  <span>Edit</span>
                </button>

                <button
                  mat-stroked-button
                  color="accent"
                  class="action-btn"
                  (click)="securityVerify(houseHelp?.id)">
                  <mat-icon>verified_user</mat-icon>
                  <span>Security</span>
                </button>

                <button
                  mat-stroked-button
                  [color]="houseHelp?.hiringStatus === 'HIRED' ? 'accent' : 'primary'"
                  class="action-btn hiring-btn"
                  (click)="markAsHired(houseHelp.id, houseHelp.hiringStatus)">
                  <mat-icon>
                    {{ houseHelp?.hiringStatus === 'HIRED' ? 'person_remove' : 'person_add' }}
                  </mat-icon>
                  @if (houseHelp?.hiringStatus === 'HIRED') {
                    <span>Mark Available</span>
                  } @else {
                    <span>Mark Hired</span>
                  }
                </button>

                <button
                  mat-stroked-button
                  color="warn"
                  class="action-btn"
                  (click)="activateHouseHelp(houseHelp.id, !houseHelp?.active)">
                  <mat-icon>
                    {{ houseHelp?.active ? 'block' : 'check_circle' }}
                  </mat-icon>
                  @if (houseHelp?.active) {
                    <span>Deactivate</span>
                  } @else {
                    <span>Activate</span>
                  }
                </button>
              </div>
            </td>
          </tr>
        }
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination-wrapper">
      <mat-paginator
        [length]="pageData.totalElements"
        [pageSize]="pageData.size"
        [pageIndex]="pageData.number"
        [pageSizeOptions]="[10, 20, 50, 100]"
        (page)="onHouseHelpPageChange($event)"
        showFirstLastButtons>
      </mat-paginator>
    </div>
  }
</mat-card>
